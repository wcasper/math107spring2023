---
layout: post
---

Notes and highlights from lecture

## Today's Objectives

* Laplacian of a graph
* Connected and disconnected graphs
* Spectral clustering

## Laplacian of a graph

The Laplacian of a graph is a matrix which is similar to the adjacency matrix, but which acts like a way of taking the second derivative of functions defined on the graph.

**Definition:** The **degree** of a vertex is the number of edges coming out of it.  The **degree matrix** is a diagonal matrix whose diagonal entries are exactly the degrees of each of the vertices.

**Definition:** Let $$A$$ and $$D$$ be the adjacency matrix and degree matrix of a graph, respectively.  The **Laplacian** of a graph is 

$$L = D-A.$$

For example, consider the graph

<center>
<img src="/math107spring2023/ws8/graph1.png" alt="Simple Example Graph" width="200">
</center>

The adjacency matrix of this graph is given by

$$A = \left[\begin{array}{cccc}
0 & 1 & 1 & 1\\
1 & 0 & 0 & 1\\
1 & 0 & 0 & 0\\
1 & 1 & 0 & 0
\end{array}\right]$$

and the degree matrix is

$$D = \left[\begin{array}{cccc}
3 & 0 & 0 & 0\\
0 & 2 & 0 & 0\\
0 & 0 & 1 & 0\\
0 & 0 & 0 & 2\\
\end{array}\right]$$

The graph Laplacian is then

$$L = D-A = \left[\begin{array}{cccc}
3  & -1 & -1 & -1\\
-1 &  2 &  0 & -1\\
-1 &  0 &  1 &  0\\
-1 & -1 &  0 &  2
\end{array}\right]$$



We can understand the Laplacian intuitively in terms of functions on a graph.  By a function on a graph, we mean a function which takes various values at each of the vertices of the graph.
In terms of linear algebra, this can be encoded as a vector of values

$$\vec v = \left[\begin{array}{c} v_1\\ v_2\\ \vdots\\ v_n\end{array}\right]$$

where $$v_j$$ represents the value of the function at vertex $$j$$.
From this point of view, the vector $$L\vec v$$ obtained by mulitiplying $$\vec v$$ by $$L$$ is something like the second derivative of the function.  Or, if you happen to have had some multivariate calculus, the Laplacian of the function.

Under this correspondence, a constant function would become a **constant vector**, a vector whose entries are all the same.
Since the derivative of a constant is zero, we would expect that the graph Laplacian $$L$$ multiplying a constant vector to be zero.
This is exactly the case.

**Theorem:** Let $$c$$ be a scalar and

$$\vec c = \left[\begin{array}{c} c\\ c\\ \vdots\\ c\end{array}\right]$$

be the constant vector.  Then

$$L\vec c = \vec 0.$$

## Connected graphs

Recall that a **path** in a graph from a vertex $$a$$ to a vertex $$b$$ is a sequence of edges which start at vertex $$a$$ and end up at vertex $$b$$.

**Definition:** A graph is **connected** if it is "all one piece", ie. there is a path beween any two vertices.  Otherwise the graph is **disconnected**.

It turns out that the Laplacian of a graph can detect whether or not a graph is connected.

**Theorem:** Let $$L$$ be the Laplacian of a graph $$G$$.  Then $$G$$ is connected if and only if the null space of $$L$$ contains only constant vectors.  Equivalently $$G$$ is disconnected if and only if $$0$$ is a repeated eigenvalue of the Laplacian of the graph $$G$$.

## Clusters in graphs

A **cluster** in a graph is a collection of vertices which are closely connected to each other in comparison to their connections elsewhere.
For example, in the graph below the red vertices are strongly interconnected to each other, but weakly connected to the blue vertices.  Likewise the blue vertices are strongly connected to each other but weakly connected elsewhere.

<center>
<img src="/math107spring2023/ws8/graph3.png" alt="Simple Cluster Graph" width="400">
</center>

* Problem 3: create a matrix $$L$$ in MATLAB whose value is the Laplacian matrix for this graph.  Double-check, this matrix should be symmetric and the sum of the entries in any row or column should be zero!

Just like the eigenvalues of the Laplacian can detect whether a graph is connected or not, they can also be used to find clusters!  This process is called **spectral clustering**.  To perform spectral clustering, we use the following steps:

1. Calculate the eigenvalues and eigenvectors of the Laplacian $$L$$
2. Set $$x$$ to be the eigenvector with the second largest eigenvalue
3. Split the vertices into two groups based on whether the corresponding entry in $$x$$ is negative or positive.

This can be accomplished in MATLAB using the following code

```MATLAB
% get the eigenvectors and eigenvalues
[evecs,evals] = eig(L,'vector');

% sort the eigenvalues from smallest to largest
[evals,ind] = sort(evals,'ascend');
evecs = evecs(:,ind);

% set x to the second smallest eigenvalue
x = evecs(:,2);

% split vertices based on sign
display('first cluster')
find(x >= 0)
display('second cluster')
find(x < 0)
```

